*“群组签吧”是一个以群组为单位的签到小程序，主要功能包括群组签到、群组互动、群组话题*

**导读**
1. 应用背景
2. 需求分析
  1. 用户需求
  2. 功能需求
3. 小程序说明
4. 交互设计
  1. 页面展示
  2. 全局规约
  3. 文字样式规约
  4. 细节欣赏
5. 技术方案
  1. 总计架构设计
  2. 核心模块技术实现
        1. 群组签到
            2. 群组互动
6. 团队介绍

# 1 应用背景

据300+份高校学生关于大学课堂点名方式的问卷调查结果显示，目前大学课堂点名主要采取以下三种方式：
* 点名签到：传统方法，耗时，存在“代签”，约占比60%；
* 使用微信公众号，如对分易：注册账号时，用户需要关注其它公众号，再验证手机号。签到功能仅限于使用签到码签到，存在远程“作弊”，约占比23%；
* 使用手机软件，如超星学习通：需要下载和更新软件，注册账号需要验证手机号，需要输入学生个人信息（包括学校名称和学号），页面含有付费课程推荐广告，约占比12%；

综上，高校课堂签到存在以下问题：
* 点名签到耗时，存在“代签“；
* 公众号和签到软件要求与签到功能无关的隐私信息，包括手机号、学生信息等；
* 存在诱导信息，存在广告；
* 签到功能不完善，签到表单复杂；

# 2 需求分析

## 2.1 用户需求

* UI 简洁好看；
* 操作简单，表单应少；
* 不要求隐私信息，不含广告；

## 2.2 功能需求

* 签到功能完整；
* 签到数据统计功能；
* 支持发送多人通知；
* 小程序与大屏设备之间的可互动性；

# 3 小程序说明

我们的设计理念为：“简单明了，不做加法”，用户信息只有简单的头像、昵称和性别，不要求其它任何隐私信息。同时我们在微信小程序“用完即走”的使用理念上，为签到表单提供自动智能填充功能，部分表单自动提交，大大降低了用户操作时间，提高了用户的使用体验。

**签到功能**：使用默认基于定位的签到，另外提供了 定位 + 签到码 双重签到选项，解决了“作弊”现象，包括但不限于高校课堂点名、学习打卡、部门考勤以及其他多人签到场景；  
**互动功能**：又称作“多人在线弹幕互动“，与配套制作的网页端一起使用(用于电脑、投影幕布等大屏幕显示设备)，适用于社团活动、部门聚会、宿舍互动等场景；  
**话题功能**：群组里的“朋友圈”，可以分享学习日记、记录生活、讨论时事。  

# 4 交互设计

团队设计人员认真学习[微信小程序设计指南](https://developers.weixin.qq.com/miniprogram/design/index.html)，从中提取出微信灰度背景，再加上目前主流的R角设计，我们称之为「灰度R角设计规范」。

## 4.1 页面展示

![图片](./public/img/little-class0.png)  
![图片](./public/img/little-class1.png)  
![图片](./public/img/little-class2.png)  

## 4.2 全局规约

1. 全局页面背景颜色使用 微信灰度色 #EDEDED，数据展示块背景颜色使用 白色 #FFFFFF；
2. 数据展示块和操作按钮均使用 R 角设计，根据其权重将 R 弧度大小分为：10px、15px、20px；
3. 将页面分为数据展示页和操作页两大类，每个页面各负其责，互不干扰，相互之间不存在耦合性；
4. 页面路由嵌套层数控制在3层以下，防止用户出现“迷路”的同时又去掉了多余的导航栏；

## 4.3 文字样式规约

文字样式是视觉交互的重中之重，与用户体验感受联系紧密。设计人员在[微信小程序设计指南关于字体样式](https://developers.weixin.qq.com/miniprogram/design/#%E5%AD%97%E4%BD%93)的基础上，对字体大小、字重以及颜色调整次数高达30次：
1. 文字大小根据权重分为 56/48rpx、40rpx、36rpx、32rpx、30/28rpx、26/24rpx 六个档次；
2. 文字颜色根据权重分为 black、#353535、gray、lightgray 四个档次；

## 4.4 细节欣赏

![图片](./public/img/little-class3.png)  
![图片](./public/img/little-class4.png)  
![图片](./public/img/little-class5.png)  

# 5 技术方案

## 5.1 总体架构设计

使用 WePY/Vue.js + Express.js + MongoDB + Nginx 技术栈。

其中前端分为小程序端和网页端。小程序端使用 WePY 开发，群组互动网页端使用 Vue.js 开发。所有前端页面均采用 Flex 布局，所有请求数据操作均进行懒加载处理，页面平均渲染耗时为 36ms，平均载入完成耗时为 176ms；  
使用 Nginx 作为请求转发中继站，将来自小程序和网页的请求均衡转发给后台服务器；  
后台使用 Express.js 框架，数据库使用文档型数据库 MongoDB。  

系统总体架构图如下图所示：
![图片](./public/img/little-class6.png)  

## 5.2 核心模块技术实现

### 5.2.1 群组签到

群组签到流程逻辑：
1. 群主创建签到：填写简单的签到表信息表单，包括签到持续时间、有效签到距离、是否开启签到码，获取当前签到位置的经纬度坐标；
2. 成员进行签到：获取当前位置的经纬度坐标，用腾讯地图服务( QQMap )计算出两点之间的距离，记作 userDistance。当 userDistance 小于等于 签到距离时，签到成功，否则失败。

流程图如下图所示：
![图片](./public/img/little-class7.png)  

技术难点：
* 获取当前位置的经纬度问题：使用微信小程序官方提供的 **wx.getLocation 接口** + **腾讯地图位置服务(QQMap)**，得到了两组当前位置的经纬度坐标数据；
* 通过两个经纬度点计算距离：使用 **QQMap** 的 calculateDistance 方法，获取两组当前位置与签到位置之间的直线距离，如果有一组或以上的数据是在符合签到距离要求，那么签到成功，否则签到失败。

### 5.2.2 群组互动

群组互动分为数据输入端和展示端。小程序作为数据输入端和展示端。网页端仅作为数据展示端，适用于电脑、投影幕布等大屏幕设备。（网页端 URL 地址：[http://www.grayclass.site](http://www.grayclass.site/)）

数据展示端会定时向服务器请求最新弹幕数据，平均间隔时间为 500ms；  
为了模拟实时互动，与网页端不同的是小程序请求弹幕数据时会附带用户的 ID，返回数据里会过滤掉该用户发送的弹幕数据。当用户新建弹幕数据时，小程序直接将内容展示出来，延迟为 0，模拟成功。

# 6 团队介绍

我们是一个来自五湖四海的团队。
* 李爽：工程师，负责项目的代码实现；
* 王杰：设计师，负责产品整体 UI 规范设计，在关键时刻总能提出独特又美观的见解；
* 曾硕：视频制作人员&测试人员，负责制作介绍图片和介绍视频；
* 秦晶晶：设计师&测试人员，在很多细节上提出优秀的解决方案，同时和视频制作人员负责产品测试。  




石墨文档原文链接：[https://shimo.im/docs/k54nPTOz7hQhRCmv/](https://shimo.im/docs/k54nPTOz7hQhRCmv/)
